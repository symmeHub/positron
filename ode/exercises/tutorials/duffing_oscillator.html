
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Vibrational energy harvesting using a Duffing oscillator &#8212; POSITRON: PythOn for Science In The Reblochon cOuNtry</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/style.css?v=f4d5f33b" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-RYTJG30T3E"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-RYTJG30T3E');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-RYTJG30T3E');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ode/exercises/tutorials/duffing_oscillator';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="&#39;https://symmehub.github.io/positron/ode/exercises/tutorials/duffing_oscillator.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Support material" href="../../../optimization/course/optimization_basics.html" />
    <link rel="prev" title="Driven Harmonic Oscillator" href="harmonic_oscillator.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo.png" class="logo__image only-light" alt="POSITRON: PythOn for Science In The Reblochon cOuNtry - Home"/>
    <script>document.write(`<img src="../../../_static/logo.png" class="logo__image only-dark" alt="POSITRON: PythOn for Science In The Reblochon cOuNtry - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    POSITRON: PythOn for Science In The Reblochon cOuNtry
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Setup your laptop</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../setup/setup.html">Installing Python</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../python_basics/python_basics.html">Python basics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../python_basics/support_material/scientific_python.html">Scientific Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../python_basics/support_material/plotting.html">Advanced plotting</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../python_basics/examples/examples.html">Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../python_basics/examples/game_of_life_full.html">Game of Life and other cellular automatons</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../python_basics/exercises/exercises.html">Exercises</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../python_basics/exercises/game_of_life_tutorial.html">Conway’s Game of Life</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Image</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../image_processing/support_material/support_material.html">Support material</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../image_processing/support_material/image_processing_basics.html">Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../image_processing/support_material/blob_orientation.html">Orientation an aspect ratio</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../image_processing/exercises/exercises.html">Exercices</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../image_processing/exercises/image_processing_tutorial.html">Tutorial: Counting objects using labeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../image_processing/exercises/image_processing_practical_work.html">Practical Work: Steel microstructure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../image_processing/exercises/image_processing_practical_work_bonus.html">Practical Work Bonus: Play with dice</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../data_analysis/support_material/support_material.html">Support material</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../data_analysis/support_material/pandas_introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_analysis/support_material/01_Linear_regression_Linear_model.html">Linear regression - Linear model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_analysis/support_material/02_Linear_regression_Advanced_Model.html">Linear regression - Advanced model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_analysis/support_material/03_Numerical_Derivation.html">Derivation of numerical data</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../data_analysis/ressources/ressources.html">Ressources</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../data_analysis/ressources/Word_Generator.html">Word Generator</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../data_analysis/exercises/exercises.html">Exercices</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../data_analysis/exercises/data_tutorial.html">Analysis of data from a weather station</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_analysis/exercises/data_practical_work.html">Practical work — Tensile test data analysis (4h)</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ODE</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../support_material/support_material.html">Support material</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../ressources/ressources.html">Ressources</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ressources/badminton.html">Modelling the trajectory of a badminton shuttlecock</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ressources/gravity.html">Simulation of a set of bodies subjected to gravity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ressources/molecular_dynamics.html">Molecular Dynamics : simulation of a crystal formation in 2D</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../exercises.html">Exercices</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="simple_pendulum.html">Simple pendulum</a></li>
<li class="toctree-l2"><a class="reference internal" href="harmonic_oscillator.html">Driven Harmonic Oscillator</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Vibrational energy harvesting using a Duffing oscillator</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Optimization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../optimization/course/optimization_basics.html">Support material</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../optimization/ressources/ressources.html">Ressources</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../optimization/ressources/interactive_optimization.html">Interactive optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optimization/ressources/river_crossing_and_more.html">Illustration : Crossing a river</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optimization/ressources/StepByStep_Optimization.html">Step by step Optimization : understanding gradient based method</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../optimization/exercises/exercises.html">Exercices</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../optimization/exercises/rosenbrock_and_curve_fiting.html">Rosenbrock function and Curve fiting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optimization/exercises/bridge_optimization.html">Optimizing a bridge structure</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Machine Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../machine_learning/support_material.html">Support material</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../machine_learning/exercises/exercises.html">Exercices</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../machine_learning/exercises/tutorials/classification_demo.html">Supervised learning using PyTorch: a toy example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../machine_learning/exercises/tutorials/genetic_snake_practical_work.html">Reinforcement learning on snake with a genetic neural network</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/symmeHub/positron/main?urlpath=lab/tree/book/ode/exercises/tutorials/duffing_oscillator.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://gpu-epu.univ-savoie.fr/hub/user-redirect/git-pull?repo=https%3A//github.com/symmeHub/positron&urlpath=lab/tree/positron/book/ode/exercises/tutorials/duffing_oscillator.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/symmeHub/positron/blob/main/book/ode/exercises/tutorials/duffing_oscillator.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/symmeHub/positron" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/symmeHub/positron/edit/main/book/ode/exercises/tutorials/duffing_oscillator.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/symmeHub/positron/issues/new?title=Issue%20on%20page%20%2Fode/exercises/tutorials/duffing_oscillator.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/ode/exercises/tutorials/duffing_oscillator.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Vibrational energy harvesting using a Duffing oscillator</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-ode-reformulation">Part 1: ODE reformulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-time-integration">Part 2: Time integration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integration">Integration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#amplitude-vs-time">Amplitude <em>vs.</em> time</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phase-plane">Phase plane</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-3-poincare-sections-and-attractors">Part 3: Poincaré sections and attractors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-4-chaos-and-strange-attractor">Part 4: Chaos and strange attractor</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> widget
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span>
</pre></div>
</div>
</div>
</details>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="vibrational-energy-harvesting-using-a-duffing-oscillator">
<span id="ode-practical-work-duffing-oscillator"></span><h1>Vibrational energy harvesting using a Duffing oscillator<a class="headerlink" href="#vibrational-energy-harvesting-using-a-duffing-oscillator" title="Link to this heading">#</a></h1>
<p><strong>Author</strong>: Ludovic Charleux (<a class="reference external" href="mailto:ludovic&#46;charleux&#37;&#52;&#48;univ-smb&#46;fr">ludovic<span>&#46;</span>charleux<span>&#64;</span>univ-smb<span>&#46;</span>fr</a>)</p>
<div class="important admonition">
<p class="admonition-title">Required files</p>
<p>In order to display figures properly, please download these images from <span id="id1">[]</span>:</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="../../../_downloads/b984d74e8f140cc622d69a48b7d7f289/huguet_experimental_setup.png"><code class="xref download docutils literal notranslate"><span class="pre">huguet_experimental_setup.png</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../../../_downloads/01bf2822ec482cc89ca7b12a7806d204/huguet_model_design.png"><code class="xref download docutils literal notranslate"><span class="pre">huguet_model_design.png</span></code></a></p></li>
</ul>
<p>And put it in your working directory along with this notebook. This tutorial is inspired by the PhD work of Thomas Huguet available <a class="reference external" href="https://tel.archives-ouvertes.fr/tel-02061864">here</a> from the INSA Lyon and the University of Savoie Mont Blanc (defended in 2018). You may download it and read it to better understand the context of this exercise.</p>
</div>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>In this tutorial, we will study the mecanical behavior of a <a class="reference external" href="https://en.wikipedia.org/wiki/Bistability">bistable oscilator</a>. This means that the system has two stable equilibrium position (think of a light switch).<br />
The system is then put under a excitation and will oscilate between its two stable position.
It is realized using the principle described on the diagram below :</p>
<p><img alt="" src="../../../_images/huguet_model_design2.png" /></p>
<p>A beam with a mass in its center is compressed to buckling.
It is then excited by means of a shaker which represents the vibrations present in the environment.<br />
An electrical extraction circuit is present but will not be modeled in this tutorial.<br />
The system has been manufactured and tested in the laboratory and is shown in the figure below :</p>
<p><img alt="" src="../../../_images/huguet_experimental_setup2.png" /></p>
<p>The differential equation associated with this system is as follows:</p>
<div class="math notranslate nohighlight">
\[
\ddot x + \dfrac{\omega_0^2}{2}\left(\dfrac{x^2}{x_{w}^2} - 1\right)x + \dfrac{\omega_0}{Q} \dot x = A_d \sin \left( \omega_d t \right)
\]</div>
<p>Where:</p>
<ul class="simple">
<li><p>The position of the mass, its speed and acceleration are respectively noted <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(\dot x\)</span> and <span class="math notranslate nohighlight">\(\ddot x\)</span>.</p></li>
<li><p>The stable equilibrium position, or <strong>well</strong> position,  is noted <span class="math notranslate nohighlight">\(\pm x_{w}\)</span> (noted <span class="math notranslate nohighlight">\(x_0\)</span> on the figure above).</p></li>
<li><p>The resonance frequency at the bottom of the well is noted <span class="math notranslate nohighlight">\(\omega_0\)</span>.</p></li>
<li><p>The quality factor is noted <span class="math notranslate nohighlight">\(Q\)</span>.</p></li>
<li><p>The excitation is defined by its amplitude <span class="math notranslate nohighlight">\(A_d\)</span> and its pulsation <span class="math notranslate nohighlight">\(\omega_d = 2 \pi f_d\)</span> where <span class="math notranslate nohighlight">\(f_d\)</span> is its frequency.</p></li>
</ul>
<p>We will discuss some interesting aspects of the bistable oscillator, including:</p>
<ul class="simple">
<li><p>Its ability to have several different solutions for the same excitation.</p></li>
<li><p>Its ability to respond chaotically in some cases.</p></li>
</ul>
<p>The numerical values of these parameters are defined here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xw</span> <span class="o">=</span> <span class="mf">0.5e-3</span>  <span class="c1"># meters</span>
<span class="n">w0</span> <span class="o">=</span> <span class="mf">121.0</span>  <span class="c1"># radians per second</span>
<span class="n">Q</span> <span class="o">=</span> <span class="mf">87.0</span>  <span class="c1"># dimensionless</span>
<span class="n">fd</span> <span class="o">=</span> <span class="mf">50.0</span>  <span class="c1"># Hertz</span>
<span class="n">wd</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">fd</span>
<span class="n">Ad</span> <span class="o">=</span> <span class="mf">2.5</span>  <span class="c1"># meters per second squared</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="part-1-ode-reformulation">
<h2>Part 1: ODE reformulation<a class="headerlink" href="#part-1-ode-reformulation" title="Link to this heading">#</a></h2>
<p>First, you are asked to reformulate the ODE to first order using the standard form seen in the course:</p>
<div class="math notranslate nohighlight">
\[
\dot X = f(X, t)
\]</div>
<p>With:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
X = \begin{bmatrix}
x_0 \\
x_1
\end{bmatrix}
= \begin{bmatrix}
x \\
\dot x
\end{bmatrix}\end{split}\]</div>
<p>And, as a consequence:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\dot X = \begin{bmatrix}
\dot x_0 \\
\dot x_1
\end{bmatrix}
= \begin{bmatrix}
\dot x \\
\ddot x
\end{bmatrix}
\end{split}\]</div>
<p>Complete the function in the following cell :</p>
<p>As a reminder here’s the equation
$<span class="math notranslate nohighlight">\(
\ddot x + \dfrac{\omega_0^2}{2}\left(\dfrac{x^2}{x_{w}^2} - 1\right)x + \dfrac{\omega_0}{Q} \dot x = A_d \sin \left( \omega_d t \right)
\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## COMPLETE THIS CELL</span>


<span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Duffing equation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">dotx</span> <span class="o">=</span> <span class="n">X</span>
    <span class="n">dotX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1">## COMPLETE</span>
    <span class="c1"># dotX[0] =</span>
    <span class="c1"># dotX[1] =</span>
    <span class="k">return</span> <span class="n">dotX</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="part-2-time-integration">
<h2>Part 2: Time integration<a class="headerlink" href="#part-2-time-integration" title="Link to this heading">#</a></h2>
<section id="integration">
<h3>Integration<a class="headerlink" href="#integration" title="Link to this heading">#</a></h3>
<p>In order to intergrate the newly created function, we will use <strong>the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html#scipy.integrate.solve_ivp">solve_ivp</a> function</strong> of scipy.integrate.</p>
<p>Integrate the equation with respect to time from a point <span class="math notranslate nohighlight">\(Y_0\)</span> of your choice (the initial state). <br />
The intergration will start at <span class="math notranslate nohighlight">\(t_0= 0\)</span> and will last for <span class="math notranslate nohighlight">\(N_t = 1000\)</span> periods. We will then evaluate the function <span class="math notranslate nohighlight">\(N_F = 180\)</span> time per period : <span class="math notranslate nohighlight">\(t_{eval}\)</span> = [<span class="math notranslate nohighlight">\(t_0\)</span>, <span class="math notranslate nohighlight">\(\frac{T}{180}\)</span>, <span class="math notranslate nohighlight">\(\frac{2T}{180}\)</span>, <span class="math notranslate nohighlight">\(\frac{3T}{180}\)</span>, … , <span class="math notranslate nohighlight">\(t_f\)</span>]<br />
(You may use the <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html">linspace</a> function of numpy).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## COMPLETE THIS CELL</span>

<span class="c1">## SETUP</span>
<span class="n">Td</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">fd</span>  <span class="c1"># PERIOD DURATION</span>
<span class="c1"># NT =  # NUMBER OF PERIODS</span>
<span class="c1"># NF =  # FRAMES PER EXCITATION PERIODS</span>
<span class="c1"># t =</span>
<span class="n">X0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>  <span class="c1"># CHANGE THE VALUES TO YOUR LIKING</span>
<span class="c1"># sol = sci.solve_ivp(fun= , t_span= ,y0= , t_eval=)</span>
<span class="c1"># x =</span>
<span class="c1"># dotx =</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="amplitude-vs-time">
<h3>Amplitude <em>vs.</em> time<a class="headerlink" href="#amplitude-vs-time" title="Link to this heading">#</a></h3>
<p>We will now plot the results as a function of time.<br />
First, try plotting <strong>the normalized the position of the mass <span class="math notranslate nohighlight">\(\frac{x}{x_w}\)</span></strong> as a function of time using <strong>the <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html">plot</a> function</strong> of matplotlib.pyplot.
In blue, plot the normalized the position for <span style="color:blue">the whole solution </span> while <span style="color:red">the last 5 periods </span> will be ploted in red.</p>
<p><strong>Remark</strong>: have a look at the <a class="reference external" href="https://numpy.org/doc/stable/user/basics.indexing.html#slicing-and-striding">Numpy slicing tutorial</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fig = plt.figure(figsize=(10, 6))</span>
<span class="c1"># ax1 = fig.add_subplot(1, 2, 1)</span>
<span class="c1"># plt.title(&quot;Whole solution&quot;)</span>
<span class="c1"># plt.plot(x= ,y= ,color= , label = &quot;Whole solution&quot;)</span>
<span class="c1"># plt.plot(x= ,y= ,color= ,label = &quot;Last 5 periods&quot;)</span>
<span class="c1"># plt.grid()</span>
<span class="c1"># plt.legend()</span>
<span class="c1"># plt.xlabel(&quot;Time, $t/T_d$&quot;)</span>
<span class="c1"># plt.ylabel(&quot;Position $x/x_{w}$&quot;)</span>
<span class="c1"># ax2 = fig.add_subplot(1, 2, 2)</span>
<span class="c1"># plt.title(&quot;Steady state&quot;)</span>
<span class="c1"># plt.plot(x= ,y= ,color= ,label = &quot;Last 5 periods&quot;)</span>
<span class="c1"># plt.grid()</span>
<span class="c1"># plt.legend()</span>
<span class="c1"># plt.xlabel(&quot;Time, $t/T_d$&quot;)</span>
<span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="phase-plane">
<h3>Phase plane<a class="headerlink" href="#phase-plane" title="Link to this heading">#</a></h3>
<p>Plot the resulting trajectory in <strong>the phase plane <span class="math notranslate nohighlight">\((\frac{x}{x_w}, \frac{\dot x}{x_w \omega_0})\)</span></strong>.<br />
As in the last plot, <span style="color:blue">the whole solution</span> will be ploted in blue while <span style="color:red">the last 5 periods</span> will be plotted in red.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plt.figure()</span>
<span class="c1"># plt.plot(x= ,y= ,color= , label = &quot;Transient regime&quot;)</span>
<span class="c1"># plt.plot(x= ,y= ,color= , label = &quot;Steady state&quot;)</span>
<span class="c1"># plt.grid()</span>
<span class="c1"># plt.xlabel(&quot;Position $x/x_{w}$&quot;)</span>
<span class="c1"># plt.ylabel(&quot;Speed, $\dot x / {\omega_d x_{w}}$&quot;)</span>
<span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
</div>
<p>Depending on your starting point, the trajectory may lead to a different steady state regime.</p>
<p><strong>Questions</strong>:</p>
<ul class="simple">
<li><p>Interpret the graphs obtained. In particular, emphasize the differences between transient and steady-state conditions. Does the latter depend on the same frequency as the acceleration imposed on the system? Is there more than one steady state? If so, how can you identify them all?</p></li>
<li><p>Propose ways to extract information on the dynamic behavior of this system.</p></li>
</ul>
<p><strong>Answers</strong>:</p>
</section>
</section>
<section id="part-3-poincare-sections-and-attractors">
<h2>Part 3: Poincaré sections and attractors<a class="headerlink" href="#part-3-poincare-sections-and-attractors" title="Link to this heading">#</a></h2>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Poincar%C3%A9_map">Poincaré section</a> is a tool developed by Henri Poincaré to observe and analyze the behavior of an integral curve.</p>
<p>A <strong>temporal Poincaré section</strong> is defined by observing the system <strong>at times separated by one period (T)</strong>, i.e. at <span class="math notranslate nohighlight">\(t = n T_d\)</span>, <span class="math notranslate nohighlight">\(n\in \mathbb{N}\)</span>   <span class="math notranslate nohighlight">\(\Leftrightarrow\)</span> <span class="math notranslate nohighlight">\([0, T_d, 2T_d, ..., N_t T_d]\)</span>.  .</p>
<p>At each period, <strong>the point ((x(t), v(t))) is plotted in phase space</strong>. This transformes the continuous motion into a <strong>discrete set of points</strong> that clearly reveals whether the dynamics is periodic, quasi-periodic, or chaotic.</p>
<p>To do this, we will <strong>construct two new lists, <code class="docutils literal notranslate"><span class="pre">xp</span></code> and <code class="docutils literal notranslate"><span class="pre">dotxp</span></code>, extracted from <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">dotx</span></code></strong>, which store the position and velocity values <strong>sampled at each period</strong>.<br />
These lists contain the coordinates of the points that form the <strong>Poincaré section</strong>.</p>
<p>Once again, plot <span style="color:blue">the whole solution</span> in blue and <span style="color:red">the last 5 periods</span> in red.</p>
<p><strong>Remark</strong>: have a look at the <a class="reference external" href="https://numpy.org/doc/stable/user/basics.indexing.html#slicing-and-striding">Numpy slicing tutorial</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># POINCARE SECTION</span>
<span class="c1"># xp = # COMPLETE</span>
<span class="c1"># dotxp =  # COMPLETE</span>

<span class="c1"># plt.figure()</span>
<span class="c1"># plt.scatter(x= ,y= ,color= , marker= , s = ,label = &quot;Poincaré Section&quot;)</span>
<span class="c1"># plt.scatter(x= ,y= ,color= , marker= , s = ,label = &quot;Attractors&quot;)</span>
<span class="c1"># plt.grid()</span>
<span class="c1"># plt.legend()</span>
<span class="c1"># plt.xlabel(&quot;Position $x/x_{w}$&quot;)</span>
<span class="c1"># plt.ylabel(&quot;Speed, $\dot x / {\omega_d x_{w}}$&quot;)</span>
<span class="c1"># plt.show()</span>
<span class="c1"># plt.close(&quot;all&quot;)</span>
</pre></div>
</div>
</div>
</div>
<p>The Poincaré section indicates that the trajectory of <strong>the system in the phase plane is a convergence to one (or more) particular points called attractors</strong>. Change the values of <span class="math notranslate nohighlight">\(Y_0\)</span> and try to find different attractors.</p>
<p><strong>Hint</strong>: try these start points</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">xw</span><span class="p">,</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">xw</span> <span class="o">*</span> <span class="n">w0</span><span class="p">])</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">xw</span><span class="p">,</span> <span class="mf">5.0</span> <span class="o">*</span> <span class="n">xw</span> <span class="o">*</span> <span class="n">w0</span><span class="p">])</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">xw</span><span class="p">,</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">xw</span> <span class="o">*</span> <span class="n">w0</span><span class="p">])</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">xw</span><span class="p">,</span> <span class="mf">5.0</span> <span class="o">*</span> <span class="n">xw</span> <span class="o">*</span> <span class="n">w0</span><span class="p">])</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">7.0</span> <span class="o">*</span> <span class="n">xw</span><span class="p">,</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">xw</span> <span class="o">*</span> <span class="n">w0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Note</strong>: write down a list of the attractors that you have found, you will used them in the next part.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">attractors</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># A LIST OF ATTRACTORS</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Bonus Question:</strong></p>
<p>How would you explain that the system can converge towards multiple attractors at the same time ?</p>
<p><strong>Answers</strong>:</p>
</section>
<section id="part-4-chaos-and-strange-attractor">
<h2>Part 4: Chaos and strange attractor<a class="headerlink" href="#part-4-chaos-and-strange-attractor" title="Link to this heading">#</a></h2>
<p>We now propose to study the system using a <strong>different excitation frequency</strong>.  In this case, you will observe that the <strong>Poincaré section  does not always converge to a point</strong>: <strong>it may instead converge to a surface</strong> called a <a class="reference external" href="https://en.wikipedia.org/wiki/Attractor#Strange_attractor">strange attractor</a>.</p>
<p>Make this strange attractor obvious by drawing the Poincaré sections.</p>
<p>To do so, reuse the methods and tools introduced in this tutorial, but apply them to the <strong>new set of parameters</strong> given below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NT =  # NUMBER OF EXCITATION PERIODS</span>
<span class="c1"># NF =  # FRAMES PER EXCITATION PERIODS</span>
<span class="n">fd</span> <span class="o">=</span> <span class="mf">25.0</span>  <span class="c1"># Hertz</span>
<span class="n">omegad</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">fd</span>
<span class="n">Td</span> <span class="o">=</span> <span class="n">fd</span><span class="o">**-</span><span class="mi">1</span>  <span class="c1"># EXCITATION FREQUENCY</span>

<span class="c1"># CODE HERE</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plt.figure()</span>
<span class="c1"># plt.scatter(x= ,y= ,color= , marker= , s = ,label = &quot;Poincaré Section&quot;)</span>
<span class="c1"># plt.scatter(x= ,y= ,color= , marker= , s = ,label = &quot;Attractors&quot;)</span>
<span class="c1"># plt.grid()</span>
<span class="c1"># plt.xlabel(&quot;Position $x/x_{w}$&quot;)</span>
<span class="c1"># plt.ylabel(&quot;Speed, $\dot x / {\omega_d x_{w}}$&quot;)</span>
<span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./ode/exercises/tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="harmonic_oscillator.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Driven Harmonic Oscillator</p>
      </div>
    </a>
    <a class="right-next"
       href="../../../optimization/course/optimization_basics.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Support material</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-ode-reformulation">Part 1: ODE reformulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-time-integration">Part 2: Time integration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integration">Integration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#amplitude-vs-time">Amplitude <em>vs.</em> time</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phase-plane">Phase plane</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-3-poincare-sections-and-attractors">Part 3: Poincaré sections and attractors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-4-chaos-and-strange-attractor">Part 4: Chaos and strange attractor</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ludovic Charleux, Emile Roux, Thibault Goyallon, Christian Elmo, Giovanni Feverati, Camille Saint-Martin
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>